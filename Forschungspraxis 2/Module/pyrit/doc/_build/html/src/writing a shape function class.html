<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Writing a shape function class &mdash; Documentation of Pyrit  documentation</title>
      <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
      <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
      <link rel="stylesheet" href="../_static/custom.css" type="text/css" />
  <!--[if lt IE 9]>
    <script src="../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
        <script src="../_static/jquery.js"></script>
        <script src="../_static/underscore.js"></script>
        <script src="../_static/_sphinx_javascript_frameworks_compat.js"></script>
        <script src="../_static/doctools.js"></script>
    <script src="../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="prev" title="Writing a specific solution class" href="writing%20a%20solution%20class.html" />
<link rel="stylesheet" type="text/css"
     href="../_static/custom.css" />


</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
            <a href="../index.html" class="icon icon-home"> Documentation of Pyrit
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">User manual</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="overview.html">Overview</a></li>
<li class="toctree-l1"><a class="reference internal" href="installation.html">Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="usage%20and%20workflow.html">Usage and Workflow</a></li>
<li class="toctree-l1"><a class="reference internal" href="create_geometry.html">Creating a geometry</a></li>
<li class="toctree-l1"><a class="reference internal" href="tutorials.html">Tutorials</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">API</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="pyrit.html">Pyrit (<code class="xref py py-mod docutils literal notranslate"><span class="pre">pyrit</span></code>)</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../api.html">Pyrit</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">For developers</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="information%20for%20developers.html">Information for developers</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="tutorials%20for%20developers.html">Tutorials for developers</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="problem%20classes.html">Problem classes</a></li>
<li class="toctree-l2"><a class="reference internal" href="solution%20classes.html">Solution classes</a></li>
<li class="toctree-l2"><a class="reference internal" href="writing%20a%20problem%20class.html">Writing a specific problem class</a></li>
<li class="toctree-l2"><a class="reference internal" href="writing%20a%20solution%20class.html">Writing a specific solution class</a></li>
<li class="toctree-l2 current"><a class="current reference internal" href="#">Writing a shape function class</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#matrix-assembly-routines">Matrix assembly routines</a></li>
<li class="toctree-l3"><a class="reference internal" href="#vector-assembly-routine">Vector assembly routine</a></li>
<li class="toctree-l3"><a class="reference internal" href="#boundary-condition-assembly-routines">Boundary condition assembly routines</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#dirichlet-boundary-conditions">Dirichlet boundary conditions</a></li>
<li class="toctree-l4"><a class="reference internal" href="#neumann-boundary-conditions">Neumann boundary conditions</a></li>
<li class="toctree-l4"><a class="reference internal" href="#robin-boundary-conditions">Robin boundary conditions</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">Documentation of Pyrit</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../index.html" class="icon icon-home"></a> &raquo;</li>
          <li><a href="tutorials%20for%20developers.html">Tutorials for developers</a> &raquo;</li>
      <li>Writing a shape function class</li>
      <li class="wy-breadcrumbs-aside">
            <a href="../_sources/src/writing a shape function class.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="writing-a-shape-function-class">
<span id="id1"></span><h1>Writing a shape function class<a class="headerlink" href="#writing-a-shape-function-class" title="Permalink to this heading"></a></h1>
<p>Writing a shape function class is a rater complex task, since all different kinds of materials, boundary conditions and
excitations have to be considered. Furthermore, the assembly of the matrices must be efficiently implemented.</p>
<p>To make this task easier, the main structure is presented here. The contents are as follows:</p>
<ol class="arabic simple">
<li><p><a class="reference internal" href="#matrix-assembly-routines">Matrix assembly routines</a></p></li>
<li><p><a class="reference internal" href="#vector-assembly-routine">Vector assembly routine</a></p></li>
</ol>
<section id="matrix-assembly-routines">
<h2>Matrix assembly routines<a class="headerlink" href="#matrix-assembly-routines" title="Permalink to this heading"></a></h2>
<p>In this category are the mass matrix and the curlcurl- or divgrad-matrix. The value here represents the material.
In <a class="reference internal" href="#tab-1">Tab 1</a>, there are listed all different combinations of properties of the value.
For each combination there is also given the signature and the return type of value.
There are also the evaluation functions, their output data and the functions to calculate the matrix elements listed.
The names of the latter must be extended by the respective matrix name.
For example, in the file it would be “calc_curlcurl_function_scalar” instead of “calc_function_scalar”.
Whenever the value is inhomogeneous or nonlinear, it is necessary to evaluate the value befor the calculation function can be used.
In this case, the output of the evaluation function can directly passed to the respective input of the calculation function.
Depending on the shape function class, it can be possible that not all of the shown kinds of value make sense.</p>
<p>To differ between the combinations of properties of value, <a class="reference internal" href="#code-1">Code 1</a> can be used.</p>
<table class="docutils align-default" id="tab-1">
<caption><span class="caption-text">Table 1: Material processing in shape function routines</span><a class="headerlink" href="#tab-1" title="Permalink to this table"></a></caption>
<colgroup>
<col style="width: 11%" />
<col style="width: 11%" />
<col style="width: 11%" />
<col style="width: 11%" />
<col style="width: 11%" />
<col style="width: 11%" />
<col style="width: 11%" />
<col style="width: 11%" />
<col style="width: 11%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Homogeneous</p></th>
<th class="head"><p>Linear</p></th>
<th class="head"><p>Isotrop</p></th>
<th class="head"><p>Time dependent</p></th>
<th class="head"><p>Signature</p></th>
<th class="head"><p>Return</p></th>
<th class="head"><p>Evaluate</p></th>
<th class="head"><p>Data format</p></th>
<th class="head"><p>Calc function</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>✓</p></td>
<td><p>✓</p></td>
<td><p>✓</p></td>
<td><p>✗</p></td>
<td><p>value</p></td>
<td><p>float</p></td>
<td><p>No</p></td>
<td><p>float</p></td>
<td><p>calc_constant_scalar</p></td>
</tr>
<tr class="row-odd"><td><p>✓</p></td>
<td><p>✓</p></td>
<td><p>✓</p></td>
<td><p>✓</p></td>
<td><p>value()</p></td>
<td><p>float</p></td>
<td><p>No</p></td>
<td><p>float</p></td>
<td><p>calc_constant_scalar</p></td>
</tr>
<tr class="row-even"><td><p>✓</p></td>
<td><p>✓</p></td>
<td><p>✗</p></td>
<td><p>✗</p></td>
<td><p>value</p></td>
<td><p>2D</p></td>
<td><p>No</p></td>
<td><p>(2,2) array</p></td>
<td><p>calc_constant_tensor</p></td>
</tr>
<tr class="row-odd"><td><p>✓</p></td>
<td><p>✓</p></td>
<td><p>✗</p></td>
<td><p>✓</p></td>
<td><p>value()</p></td>
<td><p>2D</p></td>
<td><p>No</p></td>
<td><p>(2,2) array</p></td>
<td><p>calc_constant_tensor</p></td>
</tr>
<tr class="row-even"><td><p>✓</p></td>
<td><p>✗</p></td>
<td><p>✓</p></td>
<td><p>✓ and ✗</p></td>
<td><p>value(e,kw)</p></td>
<td><p>1D</p></td>
<td><p>eval_hom_nonlin_iso</p></td>
<td><p>(E,) array</p></td>
<td><p>calc_scalar_per_elem</p></td>
</tr>
<tr class="row-odd"><td><p>✓</p></td>
<td><p>✗</p></td>
<td><p>✗</p></td>
<td><p>✓ and ✗</p></td>
<td><p>value(e,kw)</p></td>
<td><p>3D</p></td>
<td><p>eval_hom_nonlin_aniso</p></td>
<td><p>(E,2,2) array</p></td>
<td><p>calc_tensor_per_elem</p></td>
</tr>
<tr class="row-even"><td><p>✗</p></td>
<td><p>✓</p></td>
<td><p>✓</p></td>
<td><p>✓ and ✗</p></td>
<td><p>value(x,y)</p></td>
<td><p>float</p></td>
<td><p>eval_inhom_lin_iso</p></td>
<td><p>(E,N) array</p></td>
<td><p>calc_function_scalar</p></td>
</tr>
<tr class="row-odd"><td><p>✗</p></td>
<td><p>✓</p></td>
<td><p>✗</p></td>
<td><p>✓ and ✗</p></td>
<td><p>value(x,y)</p></td>
<td><p>2D</p></td>
<td><p>eval_inhom_lin_aniso</p></td>
<td><p>(E,N,2,2) array</p></td>
<td><p>calc_function_tensor</p></td>
</tr>
<tr class="row-even"><td><p>✗</p></td>
<td><p>✗</p></td>
<td><p>✓</p></td>
<td><p>✓ and ✗</p></td>
<td><p>value(x,y,e,kw)</p></td>
<td><p>float</p></td>
<td><p>eval_inhom_nonlin_iso</p></td>
<td><p>(E,N) array</p></td>
<td><p>calc_function_scalar</p></td>
</tr>
<tr class="row-odd"><td><p>✗</p></td>
<td><p>✗</p></td>
<td><p>✗</p></td>
<td><p>✓ and ✗</p></td>
<td><p>value(x,y,e,kw)</p></td>
<td><p>2D</p></td>
<td><p>eval_inhom_nonlin_aniso</p></td>
<td><p>(E,N,2,2) array</p></td>
<td><p>calc_function_tensor</p></td>
</tr>
</tbody>
</table>
<p>The values in this table are exemplarily for Cartesian coordinates in two dimensions.
For the signatures, see <a class="reference internal" href="autosummary/pyrit.ValueHandler.html#pyrit.ValueHandler" title="pyrit.ValueHandler"><code class="xref py py-class docutils literal notranslate"><span class="pre">ValueHandler</span></code></a>.
<cite>E</cite> indicates the number of elements on the physical group and <cite>N</cite> indicats the number of evaluation points of the numerical integration.</p>
<p>The entries of the column “Calc function” are explained in <a class="reference internal" href="#tab-2">Tab 2</a>.</p>
<table class="docutils align-default" id="tab-2">
<caption><span class="caption-text">Table 2: Explanations of calc functions</span><a class="headerlink" href="#tab-2" title="Permalink to this table"></a></caption>
<colgroup>
<col style="width: 50%" />
<col style="width: 50%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Calc function</p></th>
<th class="head"><p>Explanation</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>calc_constant_scalar</p></td>
<td><p>Takes one scalar value for all elements</p></td>
</tr>
<tr class="row-odd"><td><p>calc_constant_tensor</p></td>
<td><p>Takes a tensorial value for all elements</p></td>
</tr>
<tr class="row-even"><td><p>calc_scalar_per_elem</p></td>
<td><p>Takes one scalar value for each element</p></td>
</tr>
<tr class="row-odd"><td><p>calc_tensor_per_elem</p></td>
<td><p>Takes one tensorial value for each element</p></td>
</tr>
<tr class="row-even"><td><p>calc_function_scalar</p></td>
<td><p>Takes the evaluations at integration points of a scalar function on each element</p></td>
</tr>
<tr class="row-odd"><td><p>calc_function_tensor</p></td>
<td><p>Takes the evaluations at integration points of a tensorial function on each element</p></td>
</tr>
</tbody>
</table>
<div class="literal-block-wrapper docutils container" id="code-1">
<div class="code-block-caption"><span class="caption-text">Code 1: Differ material properties</span><a class="headerlink" href="#code-1" title="Permalink to this code"></a></div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">prop</span> <span class="o">=</span> <span class="n">material</span><span class="o">.</span><span class="n">get_property</span><span class="p">(</span><span class="n">mat_property_class</span><span class="p">)</span>
<span class="k">if</span> <span class="n">prop</span><span class="o">.</span><span class="n">is_homogeneous</span><span class="p">:</span>
    <span class="k">if</span> <span class="n">prop</span><span class="o">.</span><span class="n">is_linear</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">prop</span><span class="o">.</span><span class="n">is_isotropic</span><span class="p">:</span>  <span class="c1"># homogenous, linear, isotropic</span>
            <span class="k">if</span> <span class="n">prop</span><span class="o">.</span><span class="n">is_time_dependent</span><span class="p">:</span>  <span class="c1"># homogenous, linear, isotropic, time dependent</span>
                <span class="n">value</span> <span class="o">=</span> <span class="n">prop</span><span class="o">.</span><span class="n">value</span><span class="p">()</span>
            <span class="k">else</span><span class="p">:</span>  <span class="c1"># homogenous, linear, isotropic, time independent</span>
                <span class="n">value</span> <span class="o">=</span> <span class="n">prop</span><span class="o">.</span><span class="n">value</span>
            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">prop</span><span class="o">.</span><span class="n">value</span><span class="p">,</span> <span class="n">ndarray</span><span class="p">):</span>
                <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">value</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
                    <span class="c1"># One scalar value per element</span>
                <span class="k">elif</span> <span class="nb">len</span><span class="p">(</span><span class="n">value</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span> <span class="o">==</span> <span class="mi">3</span><span class="p">:</span>
                    <span class="c1"># One tensor per element</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="k">raise</span> <span class="ne">NotImplementedError</span><span class="p">(</span><span class="s1">&#39;The values shape is not supported.&#39;</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="c1"># scalar value</span>
        <span class="k">else</span><span class="p">:</span>  <span class="c1"># anisotropic</span>
            <span class="c1"># homogenous, linear, anisotropic</span>
    <span class="k">else</span><span class="p">:</span>  <span class="c1"># nonlinear</span>
        <span class="k">if</span> <span class="n">prop</span><span class="o">.</span><span class="n">is_isotropic</span><span class="p">:</span>
            <span class="c1"># homogenous, nonlinear, isotropic</span>
        <span class="k">else</span><span class="p">:</span>  <span class="c1"># anisotropic</span>
            <span class="c1"># homogenous, nonlinear, anisotropic</span>
<span class="k">else</span><span class="p">:</span>  <span class="c1"># inhomogeneous</span>
    <span class="k">if</span> <span class="n">prop</span><span class="o">.</span><span class="n">is_linear</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">prop</span><span class="o">.</span><span class="n">is_isotropic</span><span class="p">:</span>
            <span class="c1"># inhomogeneous, linear, isotropic</span>
        <span class="k">else</span><span class="p">:</span>  <span class="c1"># anisotropic</span>
            <span class="c1"># inhomogeneous, linear, anisotropic</span>
    <span class="k">else</span><span class="p">:</span>  <span class="c1"># nonlinear</span>
        <span class="k">if</span> <span class="n">prop</span><span class="o">.</span><span class="n">is_isotropic</span><span class="p">:</span>
            <span class="c1"># inhomogeneous, nonlinear, isotropic</span>
        <span class="k">else</span><span class="p">:</span>  <span class="c1"># anisotropic</span>
            <span class="c1"># inhomogeneous, nonlinear, anisotropic</span>
</pre></div>
</div>
</div>
<p>For every case, the defined functions from <a class="reference internal" href="#tab-1">Tab 1</a> have to be called.
In the curlcurl-routine for example, the call for an inhomogeneous, linear and anisotropic material would be:</p>
<div class="literal-block-wrapper docutils container" id="code-2">
<div class="code-block-caption"><span class="caption-text">Code 2: Example for an inhomogeneous, linear and anisotropic material</span><a class="headerlink" href="#code-2" title="Permalink to this code"></a></div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># inhomogeneous, linear, anisotropic</span>
<span class="n">evaluations</span> <span class="o">=</span> <span class="n">eval_inhom_lin_aniso</span><span class="p">(</span><span class="n">prop</span><span class="o">.</span><span class="n">value</span><span class="p">,</span> <span class="n">evaluation_points</span><span class="p">)</span>
<span class="n">calc_curlcurl_function_tensor</span><span class="p">(</span><span class="n">indices</span><span class="p">,</span> <span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">,</span> <span class="n">v</span><span class="p">,</span> <span class="n">weights</span><span class="p">,</span> <span class="n">evaluation_points</span><span class="p">,</span> <span class="n">evaluations</span><span class="p">,</span>
                              <span class="bp">self</span><span class="o">.</span><span class="n">b</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">c</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">__determinant_b</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">s</span><span class="p">,</span>
                              <span class="bp">self</span><span class="o">.</span><span class="n">mesh</span><span class="o">.</span><span class="n">elem2node</span><span class="p">)</span>
</pre></div>
</div>
</div>
</section>
<section id="vector-assembly-routine">
<h2>Vector assembly routine<a class="headerlink" href="#vector-assembly-routine" title="Permalink to this heading"></a></h2>
<p>The load vector routine is in this category.
The value here represents the excitation, e.g. a charge density or a current density.
In <a class="reference internal" href="#tab-3">Tab 3</a>, there are listed all different combinations of properties of the value.
The explanation of the calc functions can be found in <cite>Tab 2</cite>.</p>
<p>To differ between the combinations of properties of value, <a class="reference internal" href="#code-3">Code 3</a> can be used.</p>
<table class="docutils align-default" id="tab-3">
<caption><span class="caption-text">Table 3: Excitation processing in shape function routines</span><a class="headerlink" href="#tab-3" title="Permalink to this table"></a></caption>
<colgroup>
<col style="width: 13%" />
<col style="width: 13%" />
<col style="width: 13%" />
<col style="width: 13%" />
<col style="width: 13%" />
<col style="width: 13%" />
<col style="width: 13%" />
<col style="width: 13%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Homogeneous</p></th>
<th class="head"><p>Linear</p></th>
<th class="head"><p>Time dependent</p></th>
<th class="head"><p>Signature</p></th>
<th class="head"><p>Return</p></th>
<th class="head"><p>Evaluate</p></th>
<th class="head"><p>Data format</p></th>
<th class="head"><p>Calc function</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>✓</p></td>
<td><p>✓</p></td>
<td><p>✗</p></td>
<td><p>value</p></td>
<td><p>float</p></td>
<td><p>No</p></td>
<td><p>float</p></td>
<td><p>calc_constant_scalar</p></td>
</tr>
<tr class="row-odd"><td><p>✓</p></td>
<td><p>✓</p></td>
<td><p>✓</p></td>
<td><p>value()</p></td>
<td><p>float</p></td>
<td><p>No</p></td>
<td><p>float</p></td>
<td><p>calc_constant_scalar</p></td>
</tr>
<tr class="row-even"><td><p>✓</p></td>
<td><p>✗</p></td>
<td><p>✓ and ✗</p></td>
<td><p>value(e,kw)</p></td>
<td><p>1D</p></td>
<td><p>eval_hom_nonlin_iso</p></td>
<td><p>(E,) array</p></td>
<td><p>calc_scalar_per_elem</p></td>
</tr>
<tr class="row-odd"><td><p>✗</p></td>
<td><p>✓</p></td>
<td><p>✓ and ✗</p></td>
<td><p>value(x,y)</p></td>
<td><p>float</p></td>
<td><p>eval_inhom_lin_iso</p></td>
<td><p>(E,N) array</p></td>
<td><p>calc_function_scalar</p></td>
</tr>
<tr class="row-even"><td><p>✗</p></td>
<td><p>✗</p></td>
<td><p>✓ and ✗</p></td>
<td><p>value(x,y,e,kw)</p></td>
<td><p>float</p></td>
<td><p>eval_inhom_nonlin_iso</p></td>
<td><p>(E,N) array</p></td>
<td><p>calc_function_scalar</p></td>
</tr>
</tbody>
</table>
<div class="literal-block-wrapper docutils container" id="code-3">
<div class="code-block-caption"><span class="caption-text">Code 3: Differ excitation properties</span><a class="headerlink" href="#code-3" title="Permalink to this code"></a></div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">exci</span> <span class="o">=</span> <span class="n">excitations</span><span class="o">.</span><span class="n">get_exci</span><span class="p">(</span><span class="n">exci_id</span><span class="p">)</span>
<span class="k">if</span> <span class="n">exci</span><span class="o">.</span><span class="n">is_homogeneous</span><span class="p">:</span>
    <span class="k">if</span> <span class="n">exci</span><span class="o">.</span><span class="n">is_linear</span><span class="p">:</span>
        <span class="c1"># homogenous, linear</span>
        <span class="k">if</span> <span class="n">exci</span><span class="o">.</span><span class="n">is_time_dependent</span><span class="p">:</span>  <span class="c1"># homogeneous, linear, time dependent</span>
            <span class="n">value</span> <span class="o">=</span> <span class="n">exci</span><span class="o">.</span><span class="n">value</span><span class="p">()</span>
        <span class="k">else</span><span class="p">:</span>  <span class="c1"># homogeneous, linear, time independent</span>
            <span class="n">value</span> <span class="o">=</span> <span class="n">exci</span><span class="o">.</span><span class="n">value</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="n">ndarray</span><span class="p">):</span>
            <span class="c1"># value is an array</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="c1"># value is a constant</span>
    <span class="k">else</span><span class="p">:</span>  <span class="c1"># nonlinear</span>
        <span class="c1"># homogenous, nonlinear</span>
<span class="k">else</span><span class="p">:</span>  <span class="c1"># inhomogeneous</span>
    <span class="k">if</span> <span class="n">exci</span><span class="o">.</span><span class="n">is_linear</span><span class="p">:</span>
        <span class="c1"># inhomogeneous, linear</span>
    <span class="k">else</span><span class="p">:</span>  <span class="c1"># nonlinear</span>
        <span class="c1"># inhomogeneous, nonlinear</span>
</pre></div>
</div>
</div>
<p>Here, however, one has to deal with lower dimensional elements.
So for example if the simulation domain is two-dimensional, it is possible that there are zero- and one-dimensional entities where an excitation is defined on.</p>
</section>
<section id="boundary-condition-assembly-routines">
<h2>Boundary condition assembly routines<a class="headerlink" href="#boundary-condition-assembly-routines" title="Permalink to this heading"></a></h2>
<p>The value here represents the boundary condition.
In this category are the routines for Dirichlet, Neumann and Robin boundary conditions.
Since the boundary conditions cannot be treated the same way, they are considered separately.</p>
<section id="dirichlet-boundary-conditions">
<h3>Dirichlet boundary conditions<a class="headerlink" href="#dirichlet-boundary-conditions" title="Permalink to this heading"></a></h3>
<p>At Dirichlet boundary conditions, the user gives the normal component of a field at the boundary, i.e. a one-dimensional value.
<a class="reference internal" href="#tab-4">Tab 4</a> summarizes the different cases.</p>
<table class="docutils align-default" id="tab-4">
<caption><span class="caption-text">Table 4: Dirichlet boundary condition processing in shape function routines</span><a class="headerlink" href="#tab-4" title="Permalink to this table"></a></caption>
<colgroup>
<col style="width: 13%" />
<col style="width: 13%" />
<col style="width: 13%" />
<col style="width: 13%" />
<col style="width: 13%" />
<col style="width: 13%" />
<col style="width: 13%" />
<col style="width: 13%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Homogeneous</p></th>
<th class="head"><p>Linear</p></th>
<th class="head"><p>Time dependent</p></th>
<th class="head"><p>Signature</p></th>
<th class="head"><p>Return</p></th>
<th class="head"><p>Evaluate</p></th>
<th class="head"><p>Data format</p></th>
<th class="head"><p>Calc function</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>✓</p></td>
<td><p>✓</p></td>
<td><p>✗</p></td>
<td><p>value</p></td>
<td><p>float</p></td>
<td><p>No</p></td>
<td><p>float</p></td>
<td><p>calc_constant_scalar</p></td>
</tr>
<tr class="row-odd"><td><p>✓</p></td>
<td><p>✓</p></td>
<td><p>✓</p></td>
<td><p>value()</p></td>
<td><p>float</p></td>
<td><p>No</p></td>
<td><p>float</p></td>
<td><p>calc_constant_scalar</p></td>
</tr>
<tr class="row-even"><td><p>✓</p></td>
<td><p>✗</p></td>
<td><p>✓ and ✗</p></td>
<td><p>value(e,kw)</p></td>
<td><p>1D</p></td>
<td><p>eval_hom_nonlin_iso</p></td>
<td><p>(E,) array</p></td>
<td><p>calc_scalar_per_elem</p></td>
</tr>
<tr class="row-odd"><td><p>✗</p></td>
<td><p>✓</p></td>
<td><p>✓ and ✗</p></td>
<td><p>value(x,y)</p></td>
<td><p>float</p></td>
<td><p>eval_inhom_lin_iso</p></td>
<td><p>(E,N) array</p></td>
<td><p>calc_function_scalar</p></td>
</tr>
<tr class="row-even"><td><p>✗</p></td>
<td><p>✗</p></td>
<td><p>✓ and ✗</p></td>
<td><p>value(x,y,e,kw)</p></td>
<td><p>float</p></td>
<td><p>eval_inhom_nonlin_iso</p></td>
<td><p>(E,N) array</p></td>
<td><p>calc_function_scalar</p></td>
</tr>
</tbody>
</table>
</section>
<section id="neumann-boundary-conditions">
<h3>Neumann boundary conditions<a class="headerlink" href="#neumann-boundary-conditions" title="Permalink to this heading"></a></h3>
<p>At Neumann boundary conditions, the user gives the tangential component of a field at the boundary.
Here, the components in all dimensions must be declared. Hence, value can return a vector.
The calc functions, however, may require the value in another dimension.
So even if value returns a vector, the calc function can require a scalar.
<a class="reference internal" href="#tab-5">Tab 5</a> summarizes the different cases.
Note the following: Since one gives the tangential component of a field, it is possible that the integrand changes even though the values for the field components were constant.
This is due to the dependency on the boundary.
Imagine for example a boundary where some edges point in x and some other point in y direction.
Specifying a neumann boundary condition where the tangential field is directed in x direction does not make sense for the in y directed edges.</p>
<table class="docutils align-default" id="tab-5">
<caption><span class="caption-text">Table 5: Neumann boundary condition processing in shape function routines</span><a class="headerlink" href="#tab-5" title="Permalink to this table"></a></caption>
<colgroup>
<col style="width: 13%" />
<col style="width: 13%" />
<col style="width: 13%" />
<col style="width: 13%" />
<col style="width: 13%" />
<col style="width: 13%" />
<col style="width: 13%" />
<col style="width: 13%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Homogeneous</p></th>
<th class="head"><p>Linear</p></th>
<th class="head"><p>Time dependent</p></th>
<th class="head"><p>Signature</p></th>
<th class="head"><p>Return</p></th>
<th class="head"><p>Evaluate</p></th>
<th class="head"><p>Data format</p></th>
<th class="head"><p>Calc function</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>✓</p></td>
<td><p>✓</p></td>
<td><p>✗</p></td>
<td><p>value</p></td>
<td><p>1D</p></td>
<td><p>No</p></td>
<td><p>float</p></td>
<td><p>calc_constant_scalar</p></td>
</tr>
<tr class="row-odd"><td><p>✓</p></td>
<td><p>✓</p></td>
<td><p>✓</p></td>
<td><p>value()</p></td>
<td><p>1D</p></td>
<td><p>No</p></td>
<td><p>float</p></td>
<td><p>calc_constant_scalar</p></td>
</tr>
<tr class="row-even"><td><p>✓</p></td>
<td><p>✗</p></td>
<td><p>✓ and ✗</p></td>
<td><p>value(e,kw)</p></td>
<td><p>2D</p></td>
<td><p>eval_hom_nonlin_iso</p></td>
<td><p>(E,) array</p></td>
<td><p>calc_scalar_per_elem</p></td>
</tr>
<tr class="row-odd"><td><p>✗</p></td>
<td><p>✓</p></td>
<td><p>✓ and ✗</p></td>
<td><p>value(x,y)</p></td>
<td><p>1D</p></td>
<td><p>eval_inhom_lin_iso</p></td>
<td><p>(E,N) array</p></td>
<td><p>calc_function_scalar</p></td>
</tr>
<tr class="row-even"><td><p>✗</p></td>
<td><p>✗</p></td>
<td><p>✓ and ✗</p></td>
<td><p>value(x,y,e,kw)</p></td>
<td><p>1D</p></td>
<td><p>eval_inhom_nonlin_iso</p></td>
<td><p>(E,N) array</p></td>
<td><p>calc_function_scalar</p></td>
</tr>
</tbody>
</table>
</section>
<section id="robin-boundary-conditions">
<h3>Robin boundary conditions<a class="headerlink" href="#robin-boundary-conditions" title="Permalink to this heading"></a></h3>
<p>Robin boundary conditions can be split up into a part that uses the Neumann boundary condition part and another part
that is is (in term of the table) tha same as the Dirichlet boundary condition part.</p>
</section>
</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="writing%20a%20solution%20class.html" class="btn btn-neutral float-left" title="Writing a specific solution class" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright .</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>